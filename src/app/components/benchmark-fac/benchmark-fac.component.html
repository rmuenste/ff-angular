<mat-tab-group>
  <mat-tab label="Benchmark Intro" class="hidden-cursor">
    <div class="heading-wrapper">
      <h4>
      Flow Around A Cylinder
      </h4>
    </div>
    <div class="text-wrapper">
      Flow around a cylinder is a well-known benchmark for the evaluation of numerical algorithms for incompressible
      Navier-Stokes equations in the laminar case. It was developed in 1995 as part of the research project "Flow simulation on high-performance computers"
      funded by the German Research Association (DFG). In analogy to the 2D case a cuboid-shaped domain with a cylindrical obstacle is created and flow
      configurations for <app-mathjax [content]="'$Re = 20$'"></app-mathjax> and <app-mathjax [content]="'$Re = 100$'"></app-mathjax> are simulated. As observables for these simulations we choose the drag and lift coefficients on the cylinder.
    </div>
    <div class="text-wrapper">
      The benchmark problems are studied with the open-source software package OpenFOAM, the widely used commercial code ANSYS-CFX (CFX) and our in-house code FeatFloWer. For OpenFOAM (version 1.6)
      the icoFoam solver was used to solve the incompressible Navier-Stokes equations. For CFX (version 12.0 Service Pack 1) we used the transient Finite Volume solver to solve the fluid equations.
    </div>
    <div class="text-wrapper">
      Studying benchmark problem with these three different software packages which employ different numerical techniques also give an insight to answer of the following questions:
      <ul>
        <li>Can one construct an efficient solver for incompressible flow without employing multigrid components, at least for the pressure Poisson equation?</li>
        <li>What is the "best" strategy for time stepping: fully coupled iteration or operator splitting (pressure correction scheme)?</li>
        <li>Does it pay to use higher order discretization in space or time?</li>
      </ul>
    </div>
    <div class="video-wrapper">
    <h4>Video Rising Bubble 3D</h4>
      <video width="624" height="351" controls>
        <source src="assets/fac3d.mp4" type="video/mp4">
      </video>
    </div>
  </mat-tab>
  <mat-tab label="Benchmark Definition">
    <div class="heading-wrapper">
      <h4>
      Geometry and flow configurations
      </h4>
    </div>
    <div class="text-wrapper">
    The solvers are tested in two benchmark configurations with an incompressible Newtonian fluid whose kinematic viscosity <app-mathjax [content]="'$\\nu$'"></app-mathjax> is equal to
    <app-mathjax [content]="'$10^{-3}\\frac{m^2}{s}$'"></app-mathjax> and for which the conservation equations of mass and momentum are written as follows:
    </div>
    <div class="equation-wrapper">
      <app-mathjax [content]="'$ \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u} = -\\nabla p + \\nu \\Delta \\mathbf{u}$'"></app-mathjax>
    </div>
    <div class="equation-wrapper">
      <app-mathjax [content]="'$ \\nabla \\cdot \\mathbf{u} = \\mathbf{0}$'"></app-mathjax>
    </div>
     <div class="text-wrapper">
     The Reynolds number is defined as Re=UD/ν where U is the mean velocity of the imposed parabolic profile on the inflow boundary and D is the diameter of the cylinder. The benchmark
     geometry and the corresponding 2D mesh at the coarsest level are shown in the figure below. The 3D mesh is obtained by extruding the 2D mesh in the z direction with 4 layers of cells,
     however the first level mesh for the computations is obtained by two successive refinements via connecting opposite midpoints of the the coarsest mesh which yields a mesh of 6144 cells.
     Our preliminary studies showed that this mesh offers a good balance between accuracy and computational cost.
     </div>

     <div class="im-div">
       <h3 class="mat-h3">Initial configuration and boundary conditions for the benchmark</h3>
       <img src="assets/fac_geo_3d.png" alt="FAC3D Geometry">
     </div>

     <div class="im-div">
       <h3 class="mat-h3">Base mesh for the benchmark</h3>
       <img src="assets/meshV3_side_new.png" alt="FAC3D Geometry" width="699px">
     </div>
     <div class="text-wrapper">
     The software tools employ different numerical approaches to the discretization in space which leads to different numbers of degrees of freedom (DOF) for the same problem. In the case
     of OpenFOAM and CFX, the numbers of DOF are comparable while FeatFlow has a greater number of DOF for the same mesh due to a high order finite element approximation. Therefore, while
     comparing the results, reader should keep in mind that for the same computational mesh, FeatFlow has approximately as many DOF as the others have at one level finer grid. The number
     of DOF is always proportional to number of cells (equivalent to number of vertices for hexahedral meshes with large number of cells) in all CFD packages. The numbers of DOF are
     presented with respect to the number of cells of the corresponding mesh levels in the table below.
     <ul>
       <li>ndof = 3 · nvt for velocity and ndof = nvt for pressure in case of CFX</li>
       <li>ndof = 3 · nel for velocity and ndof = nel for pressure in case of OpenFOAM</li>
       <li>ndof = 24 · nvt for velocity and ndof = 4 · nel for pressure in case of FeatFlow</li>
     </ul>
     where ndof, nvt and nel denote the number of DOF, the number of vertices and the number of cells, respectively.
     </div>

<div class="table-wrapper">
<table mat-table [dataSource]="dataSource" class="mat-elevation-z8">

  <!--- Note that these columns can be defined in any order.
        The actual rendered columns are set as a property on the row definition" -->

  <!-- Position Column -->
  <ng-container matColumnDef="level">
    <th mat-header-cell *matHeaderCellDef> Levels </th>
    <td mat-cell *matCellDef="let element"> {{element.level}} </td>
  </ng-container>

  <!-- Cells Column -->
  <ng-container matColumnDef="cells">
    <th mat-header-cell *matHeaderCellDef> # of cells </th>
    <td mat-cell *matCellDef="let element"> {{element.cells}} </td>
  </ng-container>

  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef> Name </th>
    <td mat-cell *matCellDef="let element"> {{element.name}} </td>
  </ng-container>

  <!-- Weight Column -->
  <ng-container matColumnDef="dofu">
    <th mat-header-cell *matHeaderCellDef> # of DOF u </th>
    <td mat-cell *matCellDef="let element"> {{element.dofu}} </td>
  </ng-container>

  <!-- Symbol Column -->
  <ng-container matColumnDef="dofp">
    <th mat-header-cell *matHeaderCellDef> # of DOF p </th>
    <td mat-cell *matCellDef="let element"> {{element.dofp}} </td>
  </ng-container>

  <!-- doft Column -->
  <ng-container matColumnDef="doft">
    <th mat-header-cell *matHeaderCellDef>total # of DOF</th>
    <td mat-cell *matCellDef="let element"> {{element.doft}} </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>
</div>
<div class="text-wrapper">
The first benchmark problem is at <app-mathjax [content]="'$Re=20$'"></app-mathjax> and has been studied numerically by many research groups, and very accurate results have been presented. The second benchmark problem is unsteady,
with a time-varying inflow profile which is very challenging and has not been rigorously studied, consequently the results have not yet been precisely determined. For the benchmark
problems, no-slip boundary condition is employed on the walls and natural do-nothing boundary conditions are imposed at the outflow plane. The inflow conditions are set with <app-mathjax [content]="'$U_m=0.45 m/s$'"></app-mathjax>
and <app-mathjax [content]="'$U_m=2.25 m/s$'"></app-mathjax> for the first and the second benchmark problem with the parabolic velocity profiles from the following two equations:
</div>
<div class="equation-wrapper">
  <app-mathjax [content]="'$$\\begin{aligned} \\mathbf{U}(0, y, z) &= 16U_m yz(H - y)(H - z)/H^4,\\; V = W = 0 \\\\
                                            \\mathbf{U}(0, y, z) &= 16U_m yz \\sin(\\pi t / 8) (H - y)(H - z)/H^4,\\; V = W = 0
  \\end{aligned}$$'"></app-mathjax>
</div>
The drag and lift force on the cylinder we evalute as follows:
<div class="equation-wrapper">
  <app-mathjax [content]="'$$\\begin{aligned} \\mathbf{F}_D = \\int \\left (  \\rho \\nu \\frac{\\partial v_t}{\\partial n}n_y - pn_x\\right) dS \\\\
                                              \\mathbf{F}_L =-\\int \\left ( \\rho \\nu \\frac{\\partial v_t}{\\partial n}n_x - pn_y\\right) dS
  \\end{aligned}$$'"></app-mathjax>
</div>
<div class="text-wrapper">
  where S is the surface of the cylinder, <app-mathjax [content]="'$\\mathbf{n}$'"></app-mathjax> the normal on S, <app-mathjax [content]="'$\\mathbf{v}_t$'"></app-mathjax> the tangential velocity
  on S with tangent vector <app-mathjax [content]="'$t=(n_y, -n_x, 0)$'"></app-mathjax>.

</div>
  </mat-tab>
  <mat-tab label="Verification">
    <div class="heading-wrapper">
      <h4>
     Verification and Results
      </h4>
    </div>
    <div class="text-wrapper">
The old results for <app-mathjax [content]="'$c_{Dmax}$'"></app-mathjax> and <app-mathjax [content]="'$c_{Lmin}$'"></app-mathjax> had been given within the intervals, [3.2000,3.3000]
and [0.0020,0.0040] respectively, by Turek et al., and <app-mathjax [content]="'$c_{Dmax}$'"></app-mathjax> has been determined as 3.2968
by John. These old results are not sufficient and accurate enough to establish an inclusive
benchmark study. Besides, to evaluate the results of benchmark calculations with respect to
only <app-mathjax [content]="'$c_{Dmax}$'"></app-mathjax> and <app-mathjax [content]="'$c_{Lmin}$'"></app-mathjax> is not much elucidating on the accuracy of the results. Hence,
additional to the comparison of <app-mathjax [content]="'$c_{Dmax}$'"></app-mathjax> and <app-mathjax [content]="'$c_{Lmin}$'"></app-mathjax> values, we also compare the solution
regarding <app-mathjax [content]="'$L_{2}$'"></app-mathjax> error and <app-mathjax [content]="'$L_{\\infty}$'"></app-mathjax> error which denotes the <app-mathjax [content]="'$L_{2}$'"></app-mathjax> norm of the error normalized by <app-mathjax [content]="'$L_{2}$'"></app-mathjax> norm of the reference
solution and the <app-mathjax [content]="'$L_{\\infty}$'"></app-mathjax> norm of error, respectively, are obtained through the following
calculation steps:
  <ul class="fac-ul">
    <li>
    An equidistant discrete time step is specified for which <app-mathjax [content]="'$L_{2}$'"></app-mathjax> error is independent of the step
    size. The reference solution and the other solutions are interpolated (linear interpolation) to the specified discrete time step.
    </li>
    <li>
    <app-mathjax [content]="'$L_{2}$'"></app-mathjax> norm and <app-mathjax [content]="'$L_{\\infty}$'"></app-mathjax> norm of the differences between reference solution and other solutions are calculated.
    </li>
  </ul>
Results of the benchmark calculations for FeatFlow are plotted here. Values of the comparison criteria, <app-mathjax [content]="'$L_{2}$'"></app-mathjax> error, <app-mathjax [content]="'$L_{\\infty}$'"></app-mathjax> error and relative errors
due to the comparison criteria are given here and here.

The finest level results are presented in the table below; the second table compares the relative errors. It is obvious that the results are in agreement. An interesting finding is that the FeatFlow results at level 2 are as accurate as results of CFX or OpenFOAM at the finest level.
    </div>
    <div class="table-wrapper">
    <table mat-table [dataSource]="dataSourceDragTime" class="mat-elevation-z8">

      <!--- Note that these columns can be defined in any order.
            The actual rendered columns are set as a property on the row definition" -->

      <!-- Case Column -->
      <ng-container matColumnDef="case">
        <th mat-header-cell *matHeaderCellDef> Case </th>
        <td mat-cell *matCellDef="let element"> {{element.case}} </td>
      </ng-container>

      <!-- cells Column -->
      <ng-container matColumnDef="cells">
        <th mat-header-cell *matHeaderCellDef> # of cells </th>
        <td mat-cell *matCellDef="let element"> {{element.cells}} </td>
      </ng-container>

      <!-- dragmax Column -->
      <ng-container matColumnDef="dragmax">
        <th mat-header-cell *matHeaderCellDef> <app-mathjax [content]="'$c_{Dmax}$'"></app-mathjax> </th>
        <td mat-cell *matCellDef="let element"> {{element.dragmax}} </td>
      </ng-container>

      <!-- liftmax Column -->
      <ng-container matColumnDef="liftmax">
        <th mat-header-cell *matHeaderCellDef> <app-mathjax [content]="'$c_{Lmax}$'"></app-mathjax> </th>
        <td mat-cell *matCellDef="let element"> {{element.liftmax}} </td>
      </ng-container>

      <!-- liftmin Column -->
      <ng-container matColumnDef="liftmin">
        <th mat-header-cell *matHeaderCellDef> <app-mathjax [content]="'$c_{Lmin}$'"></app-mathjax> </th>
        <td mat-cell *matCellDef="let element"> {{element.liftmin}} </td>
      </ng-container>

      <!-- tstep Column -->
      <ng-container matColumnDef="tstep">
        <th mat-header-cell *matHeaderCellDef>Tstep (s)</th>
        <td mat-cell *matCellDef="let element"> {{element.tstep}} </td>
      </ng-container>

      <!-- time Column -->
      <ng-container matColumnDef="time">
        <th mat-header-cell *matHeaderCellDef>Time (s)</th>
        <td mat-cell *matCellDef="let element"> {{element.time}} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsDragTime"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsDragTime;"></tr>
    </table>
    </div>

    <div class="im-div">
      <h3 class="mat-h3">Drag coefficient for the second benchmark</h3>
      <img src="assets/fac3/Fd_Q2P1_paper.png" alt="FAC3D Geometry" width="500px">
    </div>
    <div class="im-div">
      <h3 class="mat-h3">Lift coefficient for the second benchmark</h3>
      <img src="assets/fac3/Fl_Q2P1_paper.png" alt="FAC3D Geometry" width="500px">
    </div>
    <div class="im-div">
      <h3 class="mat-h3">Zoom on the drag coefficient</h3>
      <img src="assets/fac3/zoom_Fd_Q2P1_paper.png" alt="FAC3D Geometry" width="500px">
    </div>
    <div class="im-div">
      <h3 class="mat-h3">Zoom on the lift coefficient</h3>
      <img src="assets/fac3/zoom_Fl_Q2P1_paper.png" alt="FAC3D Geometry" width="500px">
    </div>

  </mat-tab>



  <mat-tab label="Reference Data">
    <div class="heading-wrapper">
      <h4>
     Reference Data
      </h4>
    </div>
    <div class="table-wrapper">
    <table mat-table [dataSource]="dataSourceRefData" class="mat-elevation-z8">

      <!--- Note that these columns can be defined in any order.
            The actual rendered columns are set as a property on the row definition" -->

      <!-- Column Column -->
      <ng-container matColumnDef="column">
        <th mat-header-cell *matHeaderCellDef> Column </th>
        <td mat-cell *matCellDef="let element"> {{element.column}} </td>
      </ng-container>

      <!-- Quantity Column -->
      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef> Quantity </th>
        <td mat-cell *matCellDef="let element"> {{element.quantity}} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsRefData"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsRefData;"></tr>
    </table>
    </div>
    <div class="table-wrapper">
    <table mat-table [dataSource]="dataSourceFiles" class="mat-elevation-z8">

      <!--- Note that these columns can be defined in any order.
            The actual rendered columns are set as a property on the row definition" -->

      <!-- File Column -->
      <ng-container matColumnDef="file">
        <th mat-header-cell *matHeaderCellDef> File </th>
        <td mat-cell *matCellDef="let element"> {{element.file}} </td>
      </ng-container>

      <!-- Action Column -->
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef> Action </th>
        <td mat-cell *matCellDef="let element">
          <a href="assets/files/fac3d/BenchValues.txt">{{element.action}}</a>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsFiles"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumnsFiles;"></tr>
    </table>
    </div>
    <div class="text-wrapper">
    <h4>
    GnuPlot
    </h4>
    The file contains the benchmarks results and can be plotted with the following gnuplot commands:
    <pre>
set xrange[0:8];
set yrange [-0.5:3.5];
plot "BenchValues.txt" using ($1):($2) with lines lt 2 t "drag"

set xrange[0:8];
set yrange [-0.015:0.005];
plot "BenchValues.txt" using ($1):($3) with lines lt 1 t "lift"
    </pre>
    </div>
  </mat-tab>
</mat-tab-group>

